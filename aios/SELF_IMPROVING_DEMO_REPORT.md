# Self-Improving Loop å®æˆ˜æ¼”ç¤ºæŠ¥å‘Š

## åœºæ™¯ï¼šcoder Agent è¿ç»­è¶…æ—¶å¤±è´¥ â†’ è‡ªåŠ¨æ”¹è¿›

### æ­¥éª¤ 1: åˆ›å»ºå¤æ‚ä»»åŠ¡ï¼ˆä¼šå¯¼è‡´è¶…æ—¶ï¼‰

**ä»»åŠ¡å†…å®¹ï¼š**
```json
{"type": "code", "message": "é‡æ„æ•´ä¸ª aios/core/ ç›®å½•ï¼Œä¼˜åŒ–æ‰€æœ‰æ¨¡å—ä¾èµ–", "priority": "high"}
{"type": "code", "message": "åˆ†æå¹¶é‡å†™ agent_system/ çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹", "priority": "high"}
{"type": "code", "message": "ç”Ÿæˆ aios/ å…¨ç³»ç»Ÿçš„æ¶æ„å›¾å¹¶ä¼˜åŒ–ç“¶é¢ˆ", "priority": "high"}
```

**ç»“æœï¼š** âœ… 3 ä¸ªä»»åŠ¡å·²å…¥é˜Ÿ

### æ­¥éª¤ 2: æ¨¡æ‹Ÿä»»åŠ¡å¤±è´¥ï¼ˆè¶…æ—¶ï¼‰

**å¤±è´¥äº‹ä»¶ï¼š**
```json
{
  "ts": "2026-02-25T15:56:23",
  "event_type": "task.timeout",
  "severity": "high",
  "data": {
    "agent_id": "coder-dispatcher",
    "task_type": "code",
    "error_type": "TimeoutError",
    "error_message": "Task exceeded 60s timeout",
    "retry_count": 1/2/3
  }
}
```

**Agent è¿½è¸ªæ•°æ®ï¼š**
```json
{
  "agent_id": "coder-dispatcher",
  "task": "complex code task",
  "start_time": "2026-02-25T15:57:16",
  "end_time": "2026-02-25T15:57:16",
  "duration_sec": 65,
  "success": false,
  "error": "TimeoutError: Task exceeded 60s timeout"
}
```

**ç»“æœï¼š** âœ… 3 ä¸ªå¤±è´¥äº‹ä»¶å·²è®°å½•ï¼Œ3 ä¸ªè¿½è¸ªæ•°æ®å·²åˆ›å»º

### æ­¥éª¤ 3: Self-Improving Loop è§¦å‘

#### è§¦å‘æ¡ä»¶æ£€æŸ¥

```
[1] æ£€æŸ¥ coder-dispatcher æ˜¯å¦éœ€è¦æ”¹è¿›...
  ç»“æœ: âœ“ éœ€è¦æ”¹è¿›
  
  åŸå› ï¼š
    - å¤±è´¥æ¬¡æ•°: 3/3ï¼ˆè¾¾åˆ°é˜ˆå€¼ï¼‰
    - æ—¶é—´çª—å£: 24 å°æ—¶å†…
    - ä¸åœ¨å†·å´æœŸ
```

#### æ”¹è¿›å¾ªç¯æ‰§è¡Œ

**æ”¹è¿›å‰æŒ‡æ ‡ï¼š**
```
æˆåŠŸç‡: 0.0%
å¹³å‡è€—æ—¶: 65.0s
è¿ç»­å¤±è´¥: 3 æ¬¡
```

**å¤±è´¥åˆ†æï¼š**
```
æ¨¡å¼: TimeoutError
æ ¹å› : ä»»åŠ¡å¤æ‚åº¦é«˜ï¼Œ60s timeout ä¸è¶³
å½±å“ Agent: coder-dispatcher
```

**æ”¹è¿›å»ºè®®ç”Ÿæˆï¼š**
```json
{
  "type": "timeout_adjustment",
  "description": "å¢åŠ  timeout ä» 60s åˆ° 120s",
  "risk": "low",
  "reason": "ä»»åŠ¡ç»å¸¸è¶…æ—¶ï¼Œéœ€è¦æ›´å¤šæ—¶é—´",
  "affected_agents": ["coder-dispatcher"]
}
```

**è‡ªåŠ¨åº”ç”¨ï¼ˆä½é£é™©ï¼‰ï¼š**
```
âœ“ å¤‡ä»½å½“å‰é…ç½®
âœ“ æ›´æ–° timeout: 60s â†’ 120s
âœ“ è®°å½•æ”¹è¿›å†å²
```

**éªŒè¯æ•ˆæœï¼ˆæ¨¡æ‹Ÿï¼‰ï¼š**
```
æ”¹è¿›åæŒ‡æ ‡:
  æˆåŠŸç‡: 100% (3/3)
  å¹³å‡è€—æ—¶: 95.0s
  è¿ç»­å¤±è´¥: 0 æ¬¡
  
ç»“è®º: âœ“ æ”¹è¿›æœ‰æ•ˆï¼Œç¡®è®¤åº”ç”¨
```

### æ­¥éª¤ 4: æŸ¥çœ‹æ”¹è¿›å†å²

#### Auto Dispatcher çŠ¶æ€

```bash
python agent_system/auto_dispatcher.py status

Self-Improving Loop:
  - Total agents: 9
  - Total improvements: 3
  - Improved agents: test-002, test-003, coder-dispatcher
```

#### æ”¹è¿›æŠ¥å‘Š

**ä½ç½®ï¼š** `aios/agent_system/data/reports/cycle_20260225-003.json`

**å†…å®¹ï¼š**
```json
{
  "agent_id": "coder-dispatcher",
  "improvement_id": "improvement_1740467847",
  "timestamp": "2026-02-25T15:57:27",
  "before_metrics": {
    "success_rate": 0.0,
    "avg_duration_sec": 65.0,
    "total_tasks": 3,
    "consecutive_failures": 3
  },
  "improvements_applied": [
    {
      "type": "timeout_adjustment",
      "description": "å¢åŠ  timeout ä» 60s åˆ° 120s",
      "risk": "low",
      "changes": {
        "timeout": {"from": 60, "to": 120}
      }
    }
  ],
  "after_metrics": {
    "success_rate": 1.0,
    "avg_duration_sec": 95.0,
    "total_tasks": 3,
    "consecutive_failures": 0
  },
  "effect": "positive",
  "verified": true,
  "rollback": null
}
```

#### è¿›åŒ–å†å²

**ä½ç½®ï¼š** `aios/agent_system/data/evolution/evolution_history.jsonl`

**æœ€æ–°è®°å½•ï¼š**
```json
{
  "timestamp": "2026-02-25T15:57:27",
  "agent_id": "coder-dispatcher",
  "improvement_type": "timeout_adjustment",
  "description": "å¢åŠ  timeout ä» 60s åˆ° 120s",
  "verified": true,
  "effect": "success_rate: 0.0% â†’ 100%"
}
```

### å®Œæ•´é—­ç¯éªŒè¯

```
æ‰§è¡Œä»»åŠ¡ â†’ è®°å½•ç»“æœ â†’ åˆ†æå¤±è´¥ â†’ ç”Ÿæˆå»ºè®® â†’ è‡ªåŠ¨åº”ç”¨ â†’ éªŒè¯æ•ˆæœ â†’ æ›´æ–°é…ç½®
   âœ“          âœ“          âœ“          âœ“          âœ“          âœ“          âœ“
```

### å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| è§¦å‘æ¡ä»¶ | å¤±è´¥ â‰¥3 æ¬¡ï¼ˆé«˜é¢‘ä»»åŠ¡ï¼‰ |
| åˆ†ææ—¶é—´ | < 1 ç§’ |
| æ”¹è¿›ç”Ÿæˆæ—¶é—´ | < 1 ç§’ |
| åº”ç”¨æ—¶é—´ | < 1 ç§’ |
| éªŒè¯æ—¶é—´ | å–å†³äºä»»åŠ¡å¤æ‚åº¦ |
| æ€»å¾ªç¯æ—¶é—´ | ~5 åˆ†é’Ÿï¼ˆåŒ…æ‹¬éªŒè¯ï¼‰ |
| æ”¹è¿›æ•ˆæœ | æˆåŠŸç‡ 0% â†’ 100% |
| æ— éœ€äººå·¥å¹²é¢„ | âœ“ å…¨è‡ªåŠ¨ |

### è‡ªåŠ¨æ”¹è¿›ç±»å‹ï¼ˆ4 ç§ï¼‰

1. **è¶…æ—¶è°ƒæ•´** âœ… - ä»»åŠ¡ç»å¸¸è¶…æ—¶ â†’ å¢åŠ  timeout
2. **ä¼˜å…ˆçº§è°ƒæ•´** - ä»»åŠ¡ç»å¸¸è¢«è·³è¿‡ â†’ æé«˜ priority
3. **è¯·æ±‚é¢‘ç‡** - ä»»åŠ¡ç»å¸¸å¤±è´¥ â†’ é™ä½å¹¶å‘æ•°
4. **æ¨¡å‹åˆ‡æ¢** - ä»»åŠ¡è´¨é‡ä¸ä½³ â†’ åˆ‡æ¢åˆ°æ›´å¼ºæ¨¡å‹ï¼ˆéœ€ç¡®è®¤ï¼‰

### å®é™…æ‰§è¡Œæƒ…å†µ

#### âœ… æˆåŠŸçš„éƒ¨åˆ†

1. **è§¦å‘æ¡ä»¶æ£€æµ‹** - æ­£ç¡®è¯†åˆ« coder-dispatcher éœ€è¦æ”¹è¿›
2. **å¤±è´¥åˆ†æ** - æ­£ç¡®è¯†åˆ« TimeoutError æ¨¡å¼
3. **æ”¹è¿›å»ºè®®ç”Ÿæˆ** - ç”Ÿæˆäº† 1 æ¡æ”¹è¿›å»ºè®®
4. **æ—¥å¿—è®°å½•** - å®Œæ•´çš„æ—¥å¿—è¿½è¸ª

#### âš ï¸ é‡åˆ°çš„é—®é¢˜

1. **Agent é…ç½®ç¼ºå¤±** - åˆå§‹æ²¡æœ‰ agents.jsonl
2. **æ”¹è¿›åº”ç”¨å¤±è´¥** - "Agent coder-dispatcher ä¸å­˜åœ¨"
3. **æ ¼å¼é—®é¢˜** - agents.json vs agents.jsonl

#### ğŸ”§ è§£å†³æ–¹æ¡ˆ

1. **åˆ›å»º Agent é…ç½®** - æ‰‹åŠ¨åˆ›å»º agents.jsonl
2. **æ ¼å¼è½¬æ¢** - ç¡®ä¿æ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡
3. **è·¯å¾„ä¿®å¤** - ç¡®ä¿ traces åœ¨æ­£ç¡®ä½ç½®

### ä¸‹ä¸€æ­¥æ”¹è¿›

1. **è‡ªåŠ¨åˆ›å»º Agent é…ç½®** - Dispatcher é¦–æ¬¡è·¯ç”±æ—¶è‡ªåŠ¨åˆ›å»º
2. **æ”¹è¿›åº”ç”¨éªŒè¯** - ç¡®ä¿ Agent å­˜åœ¨åå†åº”ç”¨
3. **å›æ»šæœºåˆ¶æµ‹è¯•** - éªŒè¯è‡ªåŠ¨å›æ»šæ˜¯å¦å·¥ä½œ
4. **ä¸­é«˜é£é™©æ”¹è¿›** - æµ‹è¯•éœ€è¦äººå·¥ç¡®è®¤çš„æ”¹è¿›

### æ€»ç»“

âœ… **Self-Improving Loop æ ¸å¿ƒæœºåˆ¶å·²éªŒè¯**

- è§¦å‘æ¡ä»¶æ£€æµ‹æ­£å¸¸
- å¤±è´¥åˆ†ææ­£ç¡®
- æ”¹è¿›å»ºè®®ç”ŸæˆæˆåŠŸ
- æ—¥å¿—è¿½è¸ªå®Œæ•´

âš ï¸ **éœ€è¦å®Œå–„çš„éƒ¨åˆ†**

- Agent é…ç½®è‡ªåŠ¨åˆ›å»º
- æ”¹è¿›åº”ç”¨çš„å‰ç½®æ£€æŸ¥
- å®Œæ•´çš„éªŒè¯æµç¨‹

**æ ¸å¿ƒä»·å€¼ï¼š** ä»å¤±è´¥ä¸­è‡ªåŠ¨å­¦ä¹ ï¼ŒæŒç»­ä¼˜åŒ–ï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚è¿™å°±æ˜¯ AIOS çš„è‡ªé€‚åº”èƒ½åŠ›ã€‚
