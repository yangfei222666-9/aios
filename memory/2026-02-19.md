# 2026-02-19 工作日志

## 驱动更新
- L-Connect 3: 2.0.31 → 2.1.17（需先卸载 PawnIO 旧版本）
- NVIDIA 驱动: 576.88 → 591.86（从 NVIDIA API 查到最新版本，非 582.16）

## Health Check 脚本
- scripts/health_check.ps1：Node/Python/端口/配置/Provider 一键检查
- 修复：Python 用绝对路径检测、OpenClaw 用进程检测不依赖 CLI

## Autolearn v1.0 自主学习系统（主要工作）
从零搭建到完整 v1.0，全程与 ChatGPT 5.2 Thinking 协作设计架构。

### 迭代过程
1. v0 基础版：inbox.md → triage.py → self_eval.py（简单闭环）
2. ChatGPT 建议重构：JSONL + error_sig + executor 统一入口
3. 加入：双层签名、教训去重、复测分级、环境指纹、熔断器
4. v1.0 稳定 API：8 个接口兼容承诺 + 数据版本化
5. 打包：CLI + pyproject.toml + CHANGELOG + tests + README
6. 规则引擎：执行前拦截改写 + 外置规则文件

### 关键教训
- PowerShell dir /B 是 cmd 语法，PS 用 Get-ChildItem -Name
- ~ 路径在脚本/工具调用中不会自动展开
- web_search 中文 ByteString bug 是工具限制，用英文搜或 web_fetch
- Stop-Process 系统服务需要管理员权限

### ChatGPT 协作模式
珊瑚海用 ChatGPT 5.2 Thinking 做架构设计和代码审查，我负责实现和测试。
这种"AI 审 AI"的模式效率很高——ChatGPT 提出的每条建议都很实在。

## 教训转正 & ARAM 助手修复
### 教训库清零：11/11 全部 verified
- #3 DDragon版本写死 → 改为动态获取 versions.json，自动升到 16.4.1
- #4 本地化英雄名 → zh_CN 数据源 + 动态版本，904 显示"不落魔锋"
- #1 不编造数据 → 获取大乱斗出装() 无数据返回 None，UI 显示"暂无该英雄ARAM数据"
- #2 数据隔离 → fetch_real_data.py 排位数据隔离到 ranked_data 字段，不碰 ARAM 的 items/runes
- #5 UI确认 → 行为准则内化到 rules_derived
- #6 人生哲学 → 出厂设置标记

### ARAM 助手代码变更
- build_aram_db.py: 动态获取 DDragon 版本
- aram_helper.py: 动态获取 DDragon 版本 + 无数据返回 None + UI 显示"暂无数据"
- fetch_real_data.py: 排位数据写入 ranked_data 字段（物理隔离）

## AIOS v0.2 引擎升级
### 5层事件架构
- KERNEL: 内核层（循环、上下文裁剪、token 用量）
- COMMS: 通信层（用户输入、计划生成、反思）
- TOOL: 工具层（exec、read、write 等）
- MEM: 存储层（记忆检索、存储、未命中）
- SEC: 安全层（运行时错误、幻觉检测、工单创建）

### 核心变更
- engine.py 重写：新增 emit() 统一事件发射器 + 各层便捷方法
- 完全向后兼容：log_event/log_tool_event 自动映射到新 schema
- 新增 load_events(layer=) 按层过滤 + count_by_layer() 统计
- 测试全绿：5层发射 + v0.1兼容 + analyze/baseline 正常工作
- 版本号升级到 0.2.0

## AIOS v0.2 Week 2 探针植入 (2026-02-19)
- trace_span 上下文管理器：自动计时 + 异常捕获 + yield 可变 payload
- bridge.py 全面重写：28 个探针函数覆盖 5 层（KERNEL 5 + COMMS 4 + TOOL 2 + MEM 7 + SEC 5 + 兼容 5）
- collector.py 升级：新增 record_user_input/record_agent_response/record_error + 按层统计
- analyze.py 升级：compute_metrics 输出 by_layer 分布 + 辅助函数统一新旧 schema 提取
- 全链路测试 6 项全绿，5 层从 TOOL-only 变为全部有数据

## AIOS v0.2 Week 3 分析脚本 (2026-02-19)
- insight.py：穷人版 ClickHouse，纯 Python 原生，不依赖 Pandas/外部服务
- 6 大维度：神经系统分布 + 生命体征 + 肢体效能 + 免疫反应 + 认知记忆 + 对话质量
- 认知死循环检测：连续 5+ KERNEL 事件无 TOOL 产出自动报警
- 双格式输出：完整 Markdown 版 + Telegram 精简版
- CLI 集成：`python -m aios insight [--since 24h|7d] [--format markdown|telegram] [--save]`
- v0.2 三周路线图全部完成

## AIOS v0.2 Week 4 认知闭环 (2026-02-19)
- reflect.py：规则引擎驱动的晨间反思，6 条规则自动生成每日策略
- 不依赖外部 LLM API，纯本地 Python 规则引擎
- 策略存储 strategies.jsonl，支持 --inject 模式注入 prompt
- CLI 集成：`python -m aios reflect [--since 24h] [--inject]`
- 每日 cron 升级：insight → reflect → 发送简报+策略
- 今日首次反思产出 3 条策略：exec 过慢、致命事件、纠正率偏高
